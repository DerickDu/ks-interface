# 知识体系管理界面 (ks-interface)

这是一个用于管理和展示知识体系结构的前端界面，基于 React、TypeScript 和 Ant Design 开发。

## 最新版本亮点

### v1.4.0 (最新更新)
- **统计面板视觉一致性优化**：统一卡片间距和圆角边框样式，确保水平/垂直间距一致
- **响应式间距系统**：按设备类型优化间距表现（移动设备12px、平板设备14px、桌面设备16px）
- **圆角边框标准化**：新增主题化CSS类，与现有Card组件保持视觉一致性
- **知识树交互体验提升**：优化节点展开/折叠逻辑，改进平滑滚动效果

### v1.3.0 主要更新
- **多层级知识树支持**：优化知识树显示逻辑，支持3层、5层及7层知识点路径完整展示
- **滚动体验升级**：实现平滑滚动和自适应高度，提升大数据量下的浏览体验
- **实体详情增强**：新增"覆盖检测"标签页，为未来功能扩展预留接口
- **UI精细化调整**：优化边框和背景样式，提升视觉体验和内容集中度

## 功能特性

### 知识树展示
- 支持多层级知识体系展示（3层、5层及7层知识点路径）
- 实现Domain -> subDomain -> 知识点的多级结构
- 按需加载机制，提升大数据量下的性能表现
- 树容器宽度自适应功能，优化不同屏幕尺寸下的显示效果
- 滚动查看功能，支持内容高度超过容器可视区域时的平滑滚动
- 节点展开/折叠时自适应高度变化，优化用户体验
- 路径层级动态判断，确保所有中间层级节点可正确查看和导航
- **新增**：优化节点展开/折叠交互逻辑，提升操作体验
- **新增**：改进平滑滚动效果，增强用户操作反馈
- **新增**：完善自定义滚动条样式，提供更佳的视觉体验

### 数据统计面板
- 提供多种维度的数据统计视图
- 响应式布局设计，适配不同屏幕尺寸
- 紧凑型UI设计，最大化信息密度
- 支持按领域、来源类型等多维度数据展示
- **新增**：卡片间距统一优化，确保视觉一致性
- **新增**：圆角边框样式标准化，提供主题化CSS类
- **新增**：设备适配间距系统（移动12px/平板14px/桌面16px）

### 搜索功能

- 支持关键字搜索
- 实时过滤显示匹配结果
- 搜索结果高亮显示

### 实体详情功能

- 实体详情模态框展示完整信息
- 多标签页设计，包含"基本信息"、"知识路径"、"知识来源"和"覆盖检测"
- 响应式设计，适配不同屏幕尺寸
- 为未来功能扩展预留接口

### 组件样式优化
- 采用CSS模块化方案，提高样式可维护性
- 移除内联样式，统一使用外部CSS文件
- 响应式设计，支持多种设备访问
- 精细化UI样式调整，提升视觉体验
- 自定义滚动条样式，增强交互体验
- 统计面板卡片间距统一优化，确保视觉一致性
- 圆角边框样式统一，提供基础样式和主题变体

## 技术架构

### 前端技术栈

- React 18.x
- TypeScript
- Ant Design 组件库
- Vite 构建工具

### 数据结构设计

#### Catalog 表结构扩展

新增了 `subDomain` 字段用于存储知识体系的第二层节点数据：

```typescript
interface Catalog {
  entity_id: string;
  path: string;
  domain: string;
  subDomain?: string; // 新增字段
}
```

### 按需加载实现

1. 首次加载时仅渲染 Domain 和 subDomain 层级数据
2. 当用户展开 subDomain 节点时，动态加载该节点下的分类及知识点数据
3. 通过优化的数据转换算法提升渲染性能
4. 实现路径层级动态判断，支持 3 层、5 层及 7 层知识点路径完整显示

### 统计面板样式统一实现
1. 统一卡片间距系统：基础间距16px，设备适配（移动12px/平板14px/桌面16px）
2. 移除所有内联样式，完全通过CSS类名控制布局和间距
3. 新增圆角边框标准化类：.card-style-div基础样式、.primary蓝色主题、.success绿色主题
4. 优化flex布局，确保卡片在不同屏幕尺寸下的自适应表现
5. 通过CSS媒体查询实现响应式间距：@media (max-width: 767px)、@media (min-width: 768px) and (max-width: 1023px)、@media (min-width: 1024px)

### 统计面板组件架构
1. 采用响应式CSS-in-JS方案，动态注入样式适配不同屏幕尺寸
2. 实现统一的间距系统：.statistics-container、.statistics-row、.statistics-card基础类
3. 支持两种显示模式：并排显示(can-show-side-by-side)和紧凑显示(cannot-show-side-by-side)
4. 设备适配：移动设备(≤767px)、平板设备(768px-1023px)、桌面设备(≥1024px)
5. 圆角边框标准化：提供基础样式和主题变体，与Ant Design Card组件保持一致

### 滚动功能实现
1. 采用CSS模块化方案实现滚动容器样式
2. 设置容器高度为calc(100vh - 200px)实现自适应
3. 自定义滚动条样式，包括轨道(#f1f1f1)、滑块(#c1c1c1)和悬停效果(#a8a8a8)
4. 实现平滑滚动和节点展开/折叠时高度自适应
5. 优化不同屏幕尺寸和设备的兼容性

### 实体详情功能

1. 采用 Ant Design Tabs 组件实现多标签页设计
2. 为未来功能扩展预留"覆盖检测"标签页接口
3. 实现响应式布局，适配不同屏幕尺寸
4. 保持与现有 tabs 样式、交互一致性

## 开发指南

### 环境准备

```bash
npm install
```

### 启动开发服务器

```bash
npm run dev
```

### 构建生产版本

```bash
npm run build
```

## 目录结构

```
src/
├── components/          # React组件
│   ├── CopyNotification.tsx # 复制通知组件
│   ├── CopyNotification.module.css # 复制通知组件样式
│   ├── EntityDetailModal.tsx # 实体详情模态框
│   ├── EntityDetailModal.module.css # 实体详情模态框样式
│   ├── Footer.tsx       # 页脚组件
│   ├── Footer.module.css # 页脚组件样式
│   ├── Header.tsx       # 页头组件
│   ├── Header.module.css # 页头组件样式
│   ├── KnowledgeTree.tsx # 知识树组件
│   ├── KnowledgeTree.module.css # 知识树组件样式
│   ├── MainLayout.tsx   # 主布局组件
│   ├── SearchComponent.tsx # 搜索组件
│   └── StatisticsPanel.tsx # 统计面板组件（新增间距统一和圆角边框样式）
├── hooks/               # 自定义React钩子
├── services/            # 数据服务
│   ├── dataService.ts   # 数据接口
│   └── mockData.ts      # 模拟数据
├── types/               # TypeScript类型定义
│   └── index.ts
└── utils/               # 工具函数
    └── dataTransform.ts # 数据转换工具
```

## 更新日志

### v1.4.0 (开发中)

#### 修改概述
本次更新主要针对统计面板视觉一致性优化，包括卡片间距统一、圆角边框样式标准化，以及知识树交互体验的进一步提升。

#### 详细变更列表

**统计面板视觉一致性优化**
- 统一所有统计卡片的间距为16px，确保水平/垂直间距一致
- 按设备类型优化间距表现：移动设备12px、平板设备14px、桌面设备16px
- 移除所有内联样式，完全通过CSS统一控制布局和间距
- 新增圆角边框样式类：.card-style-div基础样式、.primary蓝色主题、.success绿色主题
- 确保与现有"知识点统计"模块的视觉一致性

**知识树交互体验优化**
- 优化节点展开/折叠时的高度自适应逻辑
- 改进平滑滚动效果，提升用户操作体验
- 完善自定义滚动条样式，增强视觉反馈
- 优化树节点key生成策略，解决重复key问题

#### 技术实现细节

**响应式间距系统**
- 通过CSS媒体查询实现设备适配：@media (max-width: 767px)、@media (min-width: 768px) and (max-width: 1023px)、@media (min-width: 1024px)
- 统一使用gap属性控制间距，替代原有的margin/padding方案
- 优化flex布局，确保卡片在不同屏幕尺寸下的自适应表现

**圆角边框标准化**
- 基础样式：border-radius: 6px、border: 1px solid #d9d9d9、box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1)
- 主题变体：.primary匹配蓝色主题(#adc6ff)、.success匹配绿色主题(#b7eb8f)
- 保持与Ant Design Card组件的视觉一致性

#### 影响范围
- 统计面板所有卡片组件的布局和视觉表现
- 知识树组件的交互体验和视觉效果
- 响应式布局在不同设备上的表现一致性
- 整体UI的视觉统一性和专业度

#### 使用指南
- 统计面板间距已自动优化，无需手动调整
- 可通过CSS类名快速应用标准化的圆角边框样式
- 知识树交互体验已自动提升，无需额外配置
- 建议在不同设备上测试响应式表现

#### 兼容性说明
- 本次更新完全向后兼容，不影响现有功能和数据
- 新增CSS类名不会影响现有样式表现
- 建议在更新后进行全面的UI测试，确保视觉效果符合预期
- 所有优化均遵循响应式设计原则，兼容各种屏幕尺寸

### v1.3.0 (最新更新)

#### 修改概述

本次更新主要针对知识树多层级显示优化、实体详情功能增强、滚动体验改进、UI 样式精细化调整以及统计面板卡片间距统一优化，提升了系统的功能完整性和用户体验。

#### 详细变更列表

**统计面板卡片间距统一优化**
- 统一所有卡片间距为16px，更新.statistics-row、.can-show-side-by-side和.cannot-show-side-by-side下的gap值
- 按设备类型设置不同间距：移动设备12px、平板设备14px、桌面设备16px
- 移除所有内联样式，包括第二行学科卡片容器及各分类卡片的内联样式
- 通过CSS统一设置间距，添加.statistics-card和.domain-statistics-row .statistics-card的flex布局属性
- 确保水平/垂直间距一致、不同屏幕尺寸保持一致及CSS统一管理

**圆角边框样式统一**
- 添加与Card组件一致的圆角和边框样式CSS类
- 基础样式：.card-style-div（圆角6px、1px实线边框#d9d9d9、白色背景、0 2px 8px阴影）
- 主题色变体：.primary匹配知识点总量卡片蓝色主题、.success匹配通信类节点卡片绿色主题
- 确保与"知识点统计"模块现有格式保持视觉一致性

**知识树多层级显示优化**

- 修复知识树多层级显示问题，实现路径层级动态判断
- 优化 dataTransform.ts 的 convertToTreeStructure 函数，支持 3 层、5 层及 7 层知识点路径完整显示
- > 2 层时递归构建完整树形结构，≤2 层保留原逻辑
- 修复 TypeScript 构建错误，移除未使用变量/函数
- 确保所有中间层级节点可正确查看和导航

**实体详情功能增强**

- 在 EntityDetailModal.tsx 中新增"覆盖检测"标签页
- 保持与现有 tabs 样式、交互一致性
- 适配不同屏幕尺寸的响应式设计
- 为未来功能扩展预留接口

**知识树滚动体验改进**

- 实现知识树组件滚动查看功能，支持内容高度超过容器可视区域时的滚动
- 添加清晰滚动区域边界和自定义滚动条样式
- 实现平滑滚动效果，提升用户操作体验
- 添加节点展开/折叠时自适应高度变化功能
- 优化不同屏幕尺寸和设备的兼容性
- 通过 CSS 模块化实现滚动容器样式，包括滚动条宽度、轨道和滑块样式

**UI样式精细化调整**
- 移除知识树组件内边距区域的灰色背景色，使其透明或与上级容器背景色一致
- 在知识树容器最外侧内部边缘添加浅灰色边框(#e0e0e0)，增强视觉边界和内容集中度
- 优化卡片组件样式，移除重复边框和阴影，确保边框效果清晰可见
- 保持组件的滚动、展开/折叠等交互功能不受影响
- 优化知识树滚动体验，实现平滑滚动和节点展开/折叠时高度自适应
- 改进自定义滚动条样式，包括轨道、滑块和悬停效果

#### 技术实现细节

**统计面板样式统一实现**

- 通过 CSS 媒体查询实现响应式间距：移动设备 8px→12px、平板设备新增 14px、桌面设备 16px
- 移除所有内联样式，统一使用 CSS 类名控制布局和间距
- 添加.card-style-div 基础样式类和 primary/success 主题变体，确保与现有 Card 组件视觉一致
- 优化 flex 布局，确保卡片在不同屏幕尺寸下的自适应表现

**滚动功能实现**

- 添加 scrollContainer 类实现垂直滚动和自定义滚动条
- 设置容器高度为 calc(100vh - 200px)实现自适应
- 添加 smoothScroll 类实现平滑滚动效果
- 在 onExpand 函数中调用 adjustScrollArea 函数实现节点展开/折叠时滚动区域高度自适应
- 优化滚动条样式，包括轨道(#f1f1f1)、滑块(#c1c1c1)和悬停效果(#a8a8a8)

**多层级显示优化**

- 通过路径深度判断动态构建树形结构
- 优化 dataTransform.ts 的 convertToTreeStructure 函数，支持 3 层、5 层及 7 层知识点路径完整显示
- 修复 TypeScript 类型错误，提高代码质量
- 实现节点 key 生成逻辑，结合路径和 entity_id 解决重复 key 问题

#### 影响范围
- 统计面板卡片布局和间距表现
- 知识树组件的显示和交互功能
- 实体详情模态框的标签页功能
- 整体UI视觉效果和用户体验
- 响应式布局在不同设备上的表现
- 圆角边框样式的一致性和视觉统一性

#### 使用指南
- 统计面板卡片间距已统一优化，无需手动调整
- 圆角边框样式可通过CSS类名.card-style-div、.primary、.success应用
- 知识树现在支持更复杂的多层级结构展示
- 实体详情中的"覆盖检测"标签页为未来功能预留
- 滚动功能自动适应内容高度，无需手动配置
- 边框和背景色调整已自动应用，无需额外设置

#### 兼容性说明
- 本次更新完全向后兼容，不影响现有功能
- 样式系统重构不会影响API接口
- 建议在更新后进行全面UI测试，确保视觉效果符合预期
- 如有自定义样式，请迁移至对应的CSS模块文件中

### v1.2.0

#### 修改概述

本次更新主要针对 UI 组件样式优化、响应式布局改进以及代码质量提升，移除了所有内联样式，采用 CSS 模块化方案，提高了代码可维护性和性能。

#### 详细变更列表

**样式系统重构**

- 移除所有组件中的内联样式，统一采用 CSS 模块化方案
- 为所有组件添加对应的.module.css 文件，实现样式隔离
- 优化搜索组件样式，提升用户交互体验
- 实现响应式设计，支持多种设备访问

**Header 组件优化**

- 重构搜索框样式，移除内联 style 属性
- 优化搜索按钮交互效果，添加悬停和点击动画
- 改进响应式布局，适配不同屏幕尺寸
- 修复样式冲突问题，确保组件样式一致性

**MainLayout 组件增强**

- 重构数据统计面板布局，实现响应式设计
- 优化卡片组件样式，提高信息展示密度
- 改进移动端适配，确保小屏幕设备上的可用性
- 修复布局错位问题，提升整体视觉效果

**KnowledgeTree 组件改进**

- 优化树形结构样式，提高可读性
- 实现树容器宽度自适应功能
- 改进节点展开/折叠动画效果
- 优化大数据量下的渲染性能

**新增组件样式文件**

- 新增 CopyNotification.module.css
- 新增 EntityDetailModal.module.css
- 新增 Footer.module.css
- 新增 Header.module.css
- 新增 KnowledgeTree.module.css

#### 影响范围

- 所有 UI 组件的样式系统
- 响应式布局表现
- 移动端适配效果
- 组件间样式隔离

#### 使用指南

- 开发者在自定义组件样式时，请遵循 CSS 模块化规范
- 新增样式应添加到对应的.module.css 文件中
- 避免使用内联样式，保持代码一致性
- 响应式设计应使用媒体查询实现

#### 兼容性说明

- 本次更新完全向后兼容，不影响现有功能
- 新增功能不会影响现有 API 接口
- 建议在更新后测试多层级知识树展示和滚动功能
- 样式调整遵循响应式设计原则，兼容各种屏幕尺寸

### v1.2.0

#### 修改概述

本次更新主要针对 UI 组件样式优化、响应式布局改进以及代码质量提升，移除了所有内联样式，采用 CSS 模块化方案，提高了代码可维护性和性能。

#### 详细变更列表

**样式系统重构**

- 移除所有组件中的内联样式，统一采用 CSS 模块化方案
- 为所有组件添加对应的.module.css 文件，实现样式隔离
- 优化搜索组件样式，提升用户交互体验
- 实现响应式设计，支持多种设备访问

**Header 组件优化**

- 重构搜索框样式，移除内联 style 属性
- 优化搜索按钮交互效果，添加悬停和点击动画
- 改进响应式布局，适配不同屏幕尺寸
- 修复样式冲突问题，确保组件样式一致性

**MainLayout 组件增强**

- 重构数据统计面板布局，实现响应式设计
- 优化卡片组件样式，提高信息展示密度
- 改进移动端适配，确保小屏幕设备上的可用性
- 修复布局错位问题，提升整体视觉效果

**KnowledgeTree 组件改进**

- 优化树形结构样式，提高可读性
- 实现树容器宽度自适应功能
- 改进节点展开/折叠动画效果
- 优化大数据量下的渲染性能

**新增组件样式文件**

- 新增 CopyNotification.module.css
- 新增 EntityDetailModal.module.css
- 新增 Footer.module.css
- 新增 Header.module.css
- 新增 KnowledgeTree.module.css

#### 影响范围

- 所有 UI 组件的样式系统
- 响应式布局表现
- 移动端适配效果
- 组件间样式隔离

#### 使用指南

- 开发者在自定义组件样式时，请遵循 CSS 模块化规范
- 新增样式应添加到对应的.module.css 文件中
- 避免使用内联样式，保持代码一致性
- 响应式设计应使用媒体查询实现

#### 兼容性说明

- 本次更新完全向后兼容，不影响现有功能
- 新增功能不会影响现有 API 接口
- 建议在更新后测试多层级知识树展示和滚动功能
- 样式调整遵循响应式设计原则，兼容各种屏幕尺寸

### v1.1.0

#### 修改概述

本次更新主要针对 UI 组件样式优化、响应式布局改进以及代码质量提升，移除了所有内联样式，采用 CSS 模块化方案，提高了代码可维护性和性能。

#### 详细变更列表

**样式系统重构**

- 移除所有组件中的内联样式，统一采用 CSS 模块化方案
- 为所有组件添加对应的.module.css 文件，实现样式隔离
- 优化搜索组件样式，提升用户交互体验
- 实现响应式设计，支持多种设备访问

**Header 组件优化**

- 重构搜索框样式，移除内联 style 属性
- 优化搜索按钮交互效果，添加悬停和点击动画
- 改进响应式布局，适配不同屏幕尺寸
- 修复样式冲突问题，确保组件样式一致性

**MainLayout 组件增强**

- 重构数据统计面板布局，实现响应式设计
- 优化卡片组件样式，提高信息展示密度
- 改进移动端适配，确保小屏幕设备上的可用性
- 修复布局错位问题，提升整体视觉效果

**KnowledgeTree 组件改进**

- 优化树形结构样式，提高可读性
- 实现树容器宽度自适应功能
- 改进节点展开/折叠动画效果
- 优化大数据量下的渲染性能

**新增组件样式文件**

- 新增 CopyNotification.module.css
- 新增 EntityDetailModal.module.css
- 新增 Footer.module.css
- 新增 Header.module.css
- 新增 KnowledgeTree.module.css

#### 影响范围

- 所有 UI 组件的样式系统
- 响应式布局表现
- 移动端适配效果
- 组件间样式隔离

#### 使用指南

- 开发者在自定义组件样式时，请遵循 CSS 模块化规范
- 新增样式应添加到对应的.module.css 文件中
- 避免使用内联样式，保持代码一致性
- 响应式设计应使用媒体查询实现

#### 兼容性说明

- 本次更新完全向后兼容，不影响现有功能
- 新增功能不会影响现有 API 接口
- 建议在更新后测试多层级知识树展示和滚动功能
- 样式调整遵循响应式设计原则，兼容各种屏幕尺寸

### v1.0.0

#### 修改概述

本次更新主要针对 UI 组件样式优化、响应式布局改进以及代码质量提升，移除了所有内联样式，采用 CSS 模块化方案，提高了代码可维护性和性能。

#### 详细变更列表

**样式系统重构**

- 移除所有组件中的内联样式，统一采用 CSS 模块化方案
- 为所有组件添加对应的.module.css 文件，实现样式隔离
- 优化搜索组件样式，提升用户交互体验
- 实现响应式设计，支持多种设备访问

**Header 组件优化**

- 重构搜索框样式，移除内联 style 属性
- 优化搜索按钮交互效果，添加悬停和点击动画
- 改进响应式布局，适配不同屏幕尺寸
- 修复样式冲突问题，确保组件样式一致性

**MainLayout 组件增强**

- 重构数据统计面板布局，实现响应式设计
- 优化卡片组件样式，提高信息展示密度
- 改进移动端适配，确保小屏幕设备上的可用性
- 修复布局错位问题，提升整体视觉效果

**KnowledgeTree 组件改进**

- 优化树形结构样式，提高可读性
- 实现树容器宽度自适应功能
- 改进节点展开/折叠动画效果
- 优化大数据量下的渲染性能

**新增组件样式文件**

- 新增 CopyNotification.module.css
- 新增 EntityDetailModal.module.css
- 新增 Footer.module.css
- 新增 Header.module.css
- 新增 KnowledgeTree.module.css

#### 影响范围

- 所有 UI 组件的样式系统
- 响应式布局表现
- 移动端适配效果
- 组件间样式隔离

#### 使用指南

- 开发者在自定义组件样式时，请遵循 CSS 模块化规范
- 新增样式应添加到对应的.module.css 文件中
- 避免使用内联样式，保持代码一致性
- 响应式设计应使用媒体查询实现

#### 兼容性说明

- 本次更新完全向后兼容，不影响现有功能
- 新增功能不会影响现有 API 接口
- 建议在更新后测试多层级知识树展示和滚动功能
- 样式调整遵循响应式设计原则，兼容各种屏幕尺寸

### v1.0.0

#### 修改概述

本次更新主要针对 UI 组件样式优化、响应式布局改进以及代码质量提升，移除了所有内联样式，采用 CSS 模块化方案，提高了代码可维护性和性能。

#### 详细变更列表

**样式系统重构**

- 移除所有组件中的内联样式，统一采用 CSS 模块化方案
- 为所有组件添加对应的.module.css 文件，实现样式隔离
- 优化搜索组件样式，提升用户交互体验
- 实现响应式设计，支持多种设备访问

**Header 组件优化**

- 重构搜索框样式，移除内联 style 属性
- 优化搜索按钮交互效果，添加悬停和点击动画
- 改进响应式布局，适配不同屏幕尺寸
- 修复样式冲突问题，确保组件样式一致性

**MainLayout 组件增强**

- 重构数据统计面板布局，实现响应式设计
- 优化卡片组件样式，提高信息展示密度
- 改进移动端适配，确保小屏幕设备上的可用性
- 修复布局错位问题，提升整体视觉效果

**KnowledgeTree 组件改进**

- 优化树形结构样式，提高可读性
- 实现树容器宽度自适应功能
- 改进节点展开/折叠动画效果
- 优化大数据量下的渲染性能

**新增组件样式文件**

- 新增 CopyNotification.module.css
- 新增 EntityDetailModal.module.css
- 新增 Footer.module.css
- 新增 Header.module.css
- 新增 KnowledgeTree.module.css

#### 影响范围

- 所有 UI 组件的样式系统
- 响应式布局表现
- 移动端适配效果
- 组件间样式隔离

#### 使用指南

- 开发者在自定义组件样式时，请遵循 CSS 模块化规范
- 新增样式应添加到对应的.module.css 文件中
- 避免使用内联样式，保持代码一致性
- 响应式设计应使用媒体查询实现

#### 兼容性说明

- 本次更新完全向后兼容，不影响现有功能
- 新增功能不会影响现有 API 接口
- 建议在更新后测试多层级知识树展示和滚动功能
- 样式调整遵循响应式设计原则，兼容各种屏幕尺寸
